function [Ctil] = Ctil_Solver(State, TS_State)

x1 = State(1);
x2 = State(2);
x3 = State(3);
x4 = State(4);

z1 = TS_State(1);
z2 = TS_State(2);
z3 = TS_State(3);
z4 = TS_State(4);

Ctil = [(2*x1 - 2*z1)/(2*((x1 - z1)^2 + (x3 - z3)^2)^(1/2)), 0, (2*x3 - 2*z3)/(2*((x1 - z1)^2 + (x3 - z3)^2)^(1/2)), 0;
    (x2 - z2)/((x1 - z1)^2 + (x3 - z3)^2)^(1/2) - ((2*x1 - 2*z1)*((x1 - z1)*(x2 - z2) + (x3 - z3)*(x4 - z4)))/(2*((x1 - z1)^2 + (x3 - z3)^2)^(3/2)), (x1 - z1)/((x1 - z1)^2 + (x3 - z3)^2)^(1/2), (x4 - z4)/((x1 - z1)^2 + (x3 - z3)^2)^(1/2) - ((2*x3 - 2*z3)*((x1 - z1)*(x2 - z2) + (x3 - z3)*(x4 - z4)))/(2*((x1 - z1)^2 + (x3 - z3)^2)^(3/2)), (x3 - z3)/((x1 - z1)^2 + (x3 - z3)^2)^(1/2);
    -(x3 - z3)/((x1 - z1)^2*((x3 - z3)^2/(x1 - z1)^2 + 1)), 0, 1/((x1 - z1)*((x3 - z3)^2/(x1 - z1)^2 + 1)), 0];

end

